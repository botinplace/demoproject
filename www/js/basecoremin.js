document.getElementById("mysctipt").remove();var isMobile=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),nav_links_parent="nav",selected_link_class="selected-link";const nav_btns=document.querySelectorAll(nav_links_parent+" a");function get_cookie(e){let t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?unescape(t[2]):"null"}function isColorLight(e){let t=e.match(/\d+/g),n=t[0],o=t[1],l;return(299*n+587*o+114*t[2])/1e3>127.5}function setTextColorBasedOnBackground(){let e;e=isColorLight(getComputedStyle(document.body).getPropertyValue("background"))?"black":"white",document.body.style.color=e}var initPage=e=>{let t=e||document,n=t.getElementsByTagName("form");n&&initFormButtons(n);let o=t.getElementsByTagName("textarea");o&&initTextareas(o);let l=t.getElementsByTagName("a");l&&link_event(l)},TextAreasEventListener=function(){if(this.style.height="auto",this.style.height=this.scrollHeight<122?this.scrollHeight<=46?"auto":this.scrollHeight+"px":"122px",this.style.overflowY=this.scrollHeight<122?"hidden":"auto",isMobile()&&void 0!==this.id&&"msg_text"==this.id&&document.querySelector(".chat-messages")){let e=document.querySelector(".chat-footer").offsetHeight;document.querySelector(".chat-messages").setAttribute("style","height:calc(100vh - "+(195+e)+"px);")}},initTextareas=function(e){for(let t=0;t<e.length;t++)e[t].scrollHeight<122?(e[t].setAttribute("style","height:"+e[t].scrollHeight+"px;overflow-y:hidden;"),e[t].scrollHeight<=46&&e[t].setAttribute("style","height:auto;overflow-y:hidden;")):e[t].setAttribute("style","height:122px;owerflow-y:auto;"),e[t].addEventListener("input",TextAreasEventListener,!1)};window.addEventListener("resize",()=>{let e=0.01*window.innerHeight;document.documentElement.style.setProperty("--vh",e+"px")}),window.addEventListener("orientationchange",()=>{let e=0.01*window.innerHeight;document.documentElement.style.setProperty("--vh",e+"px")},!1);var ButtonsEventListener=function(e){let t=this.querySelector("button");["loading_b,sympathy"].some(e=>t.classList.contains(e))||addClass(t,"loading_b"),e.preventDefault();let n=this.querySelector('input[type="file"]');if(n){var o,l=new FormData;l.append("afile",n.files[0]),n.getAttribute("data-action")&&l.append(n.getAttribute("data-action"),!0),o=l}else{let i=this.querySelectorAll('input[name="hobbies[]"]'),s=this.querySelector("#hobbies"),r="";if(i){for(let a=0;a<i.length;a++)i[a].checked&&(r=r+(0==a?"":",")+i[a].value);s&&(s.setAttribute("name","hobbies_str"),s.value=r)}o=new FormData(this)}let c;ajaxSend(o,this.getAttribute("action")?this.getAttribute("action"):window.location.href,t,this.getAttribute("method")?this.getAttribute("method"):"GET")},initFormButtons=function(e){for(let t=0;t<e.length;t++)e[t].addEventListener("submit",ButtonsEventListener)},info_block=document.getElementById("info-block"),show_info=function(e,t=!1){return info_block||((info_block=document.createElement("div")).setAttribute("id","info-block"),info_block.classList.add("info_block"),document.querySelector("body").appendChild(info_block)),info_block.classList.remove("show"),t?info_block.style.color="red":info_block.style.color="#00ff1f",info_block.offsetHeight,info_block.textContent=e,info_block.classList.add("show"),!1},ajaxSend=(e,t,n,o)=>{var l=new URL(t, window.location.origin),i=e,o=o;let s={credentials:"same-origin","X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"};e.has("afile")?s={credentials:"same-origin","X-Requested-With":"XMLHttpRequest"}:i=JSON.stringify(e=Object.fromEntries(e));var r={method:o,headers:s,body:i};if("GET"==o)return l.search=new URLSearchParams(e).toString(),update_content(l,!0),!1;fetch(l,r).then(e=>{if(e.ok)return e.json();throw Error("Ошибка")}).then(e=>{if(e.success){if("redirect"==e.action&&(window.location.href=e.uri),"function"==e.action){let t=e.fname.toString(),o=window[t];"function"==typeof o&&(e.fvalue?o(e.fvalue):o())}else document.querySelector("input[type=file]")&&(document.querySelector("input[type=file]").value=""),show_info("Успешно!");setTimeout(function(){n.classList.remove("loading_b")},500)}else e.error?(n.classList.remove("loading_b"),document.querySelector(".error-info")&&(document.querySelector(".error-info").innerHTML=e.error_text,document.querySelector(".error-info").classList.add("red")),document.querySelector("input[name=password]")&&(document.querySelector("input[name=password]").value=""),document.querySelector("input[type=file]")&&(document.querySelector("input[type=file]").value=""),show_info(e.error_text,!0)):show_info("...",!0),setTimeout(function(){n.classList.remove("loading_b")},500)}).catch(e=>{console.log(e),show_info("Ошибка",!0),setTimeout(function(){n.classList.remove("loading_b")},500)})},elemExists=e=>!!e&&"undefined"!=e,addClass=(e,t)=>{if(!elemExists(e))return console.log("Нет элемента"),!1;e.classList.add(t),console.log("Добавить класс")},removeClass=(e,t)=>{if(!elemExists(e))return console.log("Нет элемента"),!1;e.classList.remove(t),e.classList.length<=0&&e.removeAttribute("class"),console.log("Убрать класс")};document.addEventListener("DOMContentLoaded",()=>{let e=0.01*window.innerHeight;document.documentElement.style.setProperty("--vh",e+"px"),initPage()});var browser_history=[];addEventListener("popstate",function(){let e=window.location.pathname+window.location.search;update_content(window.location.protocol+"//"+window.location.host+e);let t=!1;console.log("popstate"),console.log(888);for(let n=0;n<nav_btns.length;n++)nav_btns[n].getAttribute("href")!=e.split("?")[0]?removeClass(nav_btns[n],selected_link_class):(console.log(123),addClass(nav_btns[n],selected_link_class),t=!0);if(!t){let o=document.querySelectorAll('nav a[href="'+e.split("?")[0]+'"]');if(o.length>0){console.log(123);for(let l=0;l<o.length;l++)addClass(o[l],selected_link_class)}}},!1);const content_block=document.querySelector(".inner-content-body");function update_content(e,t){console.clear();let n=document.getElementById("loading-block");removeClass(n,"hidden");let o=new URL(e);o.searchParams.append("GetMainContentOnly",!0);let l=o.toString();fetch(l,{headers:{credentials:"same-origin","X-Requested-With":"XMLHttpRequest"}}).then(e=>e.status?e.text():"404 ошибочка").then(function(o){let l=document.querySelector(".inner-content-body");l.innerHTML=o,l.querySelectorAll("script").forEach(function(e){let t=document.createElement("script");t.textContent=e.textContent,e.parentNode.replaceChild(t,e)}),window.scrollTo(0,0),t&&(browser_history.push(e),history.pushState(null,"",e));let i=l.querySelector("#NewTitleTextByOnlyMain"),s=l.querySelector("#NewParentsUrlsByOnlyMain"),r=l.querySelector("#ReloadPageByOnlyMain");r&&document.location.reload(),i&&(console.log("New-text-Title:"+i.value),document.title=i.value);let a;s&&(a=JSON.parse(s.value),console.log(a),console.log(Array.isArray(a))),console.log(999);let c=document.querySelectorAll(nav_links_parent+" a"),d=decodeURI((window.location.pathname+window.location.search).split("?")[0]);for(let u=0;u<c.length;u++)c[u].getAttribute("href")!=d&&Array.isArray(a)&&!Boolean(a.find(e=>e===c[u].getAttribute("href")))?(console.log(987),console.log(d),removeClass(c[u],selected_link_class)):(addClass(c[u],selected_link_class),selected_true=!0);initPage(l),setTimeout(function(){addClass(n,"hidden")},1),document.querySelector(".wrapper")&&document.querySelector(".wrapper").scrollTo(0,0)}).catch(function(e){console.log(e),show_info("Не удалось загрузить страницу(",!0),setTimeout(function(){addClass(n,"hidden")},1)})}var LinksEventListener=function(e){if(!(this.hasAttribute("download")||this.getAttribute("href")&&-1!==this.getAttribute("href").indexOf("mailto:")||this.getAttribute("href")&&-1!==this.getAttribute("href").indexOf("tel:"))&&!["auth_b,reg_b","exit"].some(e=>this.classList.contains(e))&&(e.preventDefault(),"#"!=this.getAttribute("href"))){let t=window.location.protocol+"//"+window.location.host+this.getAttribute("href");if("#"==this.getAttribute("href").substr(0,1)){let n=this.getAttribute("href").substr(1);return n&&document.getElementById(n)&&document.getElementById(n).scrollIntoView({behavior:"smooth",block:"start"}),!1}if(this.getAttribute("target")&&"_blank"==this.getAttribute("target"))window.open(t,"_blank");else{let o=document.querySelectorAll(nav_links_parent+" a");console.log(777);for(let l=0;l<o.length;l++)removeClass(o[l],selected_link_class);let i=document.getElementById("side-menu");i&&(i.checked=!1),update_content(t,!0)}}};function link_event(e){for(let t=0;t<e.length;t++)e[t].addEventListener("click",LinksEventListener)}const open_modal_btn=document.getElementById("open-modal-btn"),close_modal_btn=document.getElementById("close-modal-btn"),html=document.documentElement,modal_window=document.getElementById("modal-window"),user_status=document.getElementById("user_acc_status")?document.getElementById("user_acc_status").value:0;function closeModal(){if(modal_window.classList.contains("static_window"))return!1;html.style.top="",html.style.overflow="",modal_window.classList.add("hidden")}open_modal_btn&&open_modal_btn.addEventListener("click",function(e){e.preventDefault();let t=window.scrollY;html.style.top="-"+t,html.style.overflow="hidden",modal_window.classList.remove("hidden")}),close_modal_btn.addEventListener("click",function(e){e.preventDefault(),closeModal()}),modal_window.addEventListener("click",function(e){e.target==this&&(e.preventDefault(),closeModal())}),document.onkeydown=function(e){e=e||window.event;var t=!1;(t="key"in e?"Escape"===e.key||"Esc"===e.key:27===e.keyCode)&&closeModal()};